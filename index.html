<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
  <link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet' type='text/css'>
  <link href='css/base.css' rel='stylesheet' type='text/css'>
  <script src="https://d3js.org/d3.v4.js"></script>

  <style>

  .chart rect {
    fill: steelblue;
  }

  .chart text {
    fill: white;
    font: 10px sans-serif;
    text-anchor: end;
  }
  </style>
</head>
<body>



<h2>Playground for learning d3</h2>

<svg class='chart'></svg>

<script>
d3.select("body")
  .append("div")
  .html('hello, world!')

var width = 420;
var barHeight = 20;

var chart = d3.select(".chart")
      .attr("width", width)

var x = d3.scaleLinear()
      .range([0,width]);

d3.tsv("data.tsv", type, function(error, data){
  chart.attr("height", barHeight * data.length);
  x.domain([0,d3.max(data, function(d){return d.value})]);


  var bar = chart.selectAll("g")
      .data(data)
    .enter().append("g")
      .attr("transform",function(d, i) { return "translate(0," + i * barHeight + ")";});

  bar.append("rect")
      .attr("width", function(d) {return x(d.value); } )
      .attr("height", barHeight-1);

  bar.append("text")
      .attr("x", function(d) { return x(d.value) - 3; })
      .attr("y", barHeight / 2)
      .attr("dy", ".35em")
      .text(function(d) { return d.name + ": " + d.value; });
});


function type(d) {
  d.value = +d.value; // coerce to number
  return d;
}
</script>

<svg width="720" height="120" id="circle_canvas">
</svg>
<script>
var canvas = d3.select("#circle_canvas");
//var data = [[20,30],[40,30],[60,30],[80,20],[100,10]];
var data = d3.range(5)
          .map(function(){
            return {
              x: Math.random() * 200,
              y: Math.random() * 20 + 10
            }
            ;})
canvas.selectAll("circle")
  .data(data)
.enter().append("circle")
  .attr("fill","steelblue")
  .attr("r",function(d){return 5;})
  .attr("cx",function(d){return d.x;})
  .attr("cy",function(d){return d.y;})
  .on("mouseover",function(){
    d3.select(this)
      .attr("fill","black")
    ;})
  .on("mouseout",function(){
    d3.select(this)
      .attr("fill","steelblue")
  ;})
  .call(d3.drag()
      .on("start", dragstarted)
      .on("drag", dragging)
      .on("end", dragended));

canvas.on("dblclick",function(){
    var position = d3.mouse(this)
    data = d3.select(this).selectAll("circle").data()
    data.push({
      x: position[0],
      y: position[1]
    })
    d3.select(this).selectAll("circle")
      .data(data)
    .enter().append("circle")
      .attr("fill","steelblue")
      .attr("r",10)
      .attr("cx",function(d){return d.x;})
      .attr("cy",function(d){return d.y;})
      .on("mouseover",function(){
        d3.select(this)
          .attr("fill","black")
        ;})
      .on("mouseout",function(){
        d3.select(this)
          .attr("fill","steelblue")
      ;})
      .call(d3.drag()
          .on("start", dragstarted)
          .on("drag", dragging)
          .on("end", dragended));
  ;})

function dragstarted(){
  d3.select(this).raise()
    .attr("fill","red")
}
function dragging(d){
  d3.select(this)
    .attr("fill","green")
    .attr("cx", d.x = d3.event.x)
    .attr("cy", d.y = d3.event.y)
}
function dragended(){
  d3.select(this)
    .attr("fill","steelblue")
}


</script>

</body>
</html>
